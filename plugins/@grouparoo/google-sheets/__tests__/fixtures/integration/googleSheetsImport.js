const nock = require("nock");
process.env.GOOGLE_SHEETS_JEST_TIMESTAMP = "1643140877870";

nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", { grant_type: /.+/g, assertion: /.+/g })
  .once()
  .reply(
    200,
    [
      "1f8b08000000000002ffedd44b7282300000d0bb642d0e22b1d21d6aa0e810ad58086c32888104b0443e16e9f4ee75baed15788778df204e12d634b4ad0af6095ec123d68c69323dab26b9abc3698f64497d4bc9354bbe38418ba27cb0c96e8783b210b2df9e8e6e45a07ae4874ee0a447b3c0df669979b87f798784dee4c6dfd697f69d77f965d8703177094a236839907facd9c04bcc89ececf4baf08e05a76f9575d7839ea11bf6367ba21a433abfae4c33dc6999abe8d031e8322f94b3a3a712795a166a3ac4d183d3cae7b2c3b3052c695c864e7d83bdd004590f0b89025be149d4d0fa82dddeb6b26e69b0a2998e46a37fc004b05e8a9a35543c3f9843c39880bf1c68fb90ec39c48ac535abc1cf2f3108cc8c3b040000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Tue, 25 Jan 2022 20:01:20 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", { grant_type: /.+/g, assertion: /.+/g })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "ed",
      "d4",
      "4b",
      "72",
      "82300000d0bb646d1dfe25dd295550194549f8b86108c64ac0f02d1f9ddebd4eb7bd02ef10ef09e224a14d13b5454639f800632cc1793227c222e88407da77838e69a0176dcf17aabeb5ce380823745e0f5abbdfeb56caaece28d926b2d8eee6ad4ead58c9aea95e914fde44ce735b708ba33b0ab7d4bb9038a88992dc8b4ac1ea782fb61e1ed73e46bb0b0e9db267cbf054a5b2af30b22190e020e67df8e972883670ad7e7364e6c5d010ed51613d917bd950de59dfed0e5f2d4466edcb928e0de669195aae4a7670c246090ca41d91e98977c5f6136ee7cea15b49d9e0c163339f4c26ff8019a04399d6b489d2d707b20ae10cfce510b563495f432c695cd31afcfc020b3ff6973b040000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Tue, 25 Jan 2022 20:01:21 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://sheets.googleapis.com:443", { encodedQueryParams: true })
  .get("/v4/spreadsheets/11zccS101c27B9mYLMJiaAPfDgoj2chOq39n3MZrcKTk/")
  .once()
  .reply(
    200,
    {
      spreadsheetId: "11zccS101c27B9mYLMJiaAPfDgoj2chOq39n3MZrcKTk",
      properties: {
        title: "Test Suite google-sheets",
        locale: "en_US",
        autoRecalc: "ON_CHANGE",
        timeZone: "America/Los_Angeles",
        defaultFormat: {
          backgroundColor: { red: 1, green: 1, blue: 1 },
          padding: { top: 2, right: 3, bottom: 2, left: 3 },
          verticalAlignment: "BOTTOM",
          wrapStrategy: "OVERFLOW_CELL",
          textFormat: {
            foregroundColor: {},
            fontFamily: "arial,sans,sans-serif",
            fontSize: 10,
            bold: false,
            italic: false,
            strikethrough: false,
            underline: false,
            foregroundColorStyle: { rgbColor: {} },
          },
          backgroundColorStyle: { rgbColor: { red: 1, green: 1, blue: 1 } },
        },
        spreadsheetTheme: {
          primaryFontFamily: "Arial",
          themeColors: [
            { colorType: "TEXT", color: { rgbColor: {} } },
            {
              colorType: "BACKGROUND",
              color: { rgbColor: { red: 1, green: 1, blue: 1 } },
            },
            {
              colorType: "ACCENT1",
              color: {
                rgbColor: {
                  red: 0.25882354,
                  green: 0.52156866,
                  blue: 0.95686275,
                },
              },
            },
            {
              colorType: "ACCENT2",
              color: {
                rgbColor: {
                  red: 0.91764706,
                  green: 0.2627451,
                  blue: 0.20784314,
                },
              },
            },
            {
              colorType: "ACCENT3",
              color: {
                rgbColor: {
                  red: 0.9843137,
                  green: 0.7372549,
                  blue: 0.015686275,
                },
              },
            },
            {
              colorType: "ACCENT4",
              color: {
                rgbColor: {
                  red: 0.20392157,
                  green: 0.65882355,
                  blue: 0.3254902,
                },
              },
            },
            {
              colorType: "ACCENT5",
              color: {
                rgbColor: { red: 1, green: 0.42745098, blue: 0.003921569 },
              },
            },
            {
              colorType: "ACCENT6",
              color: {
                rgbColor: {
                  red: 0.27450982,
                  green: 0.7411765,
                  blue: 0.7764706,
                },
              },
            },
            {
              colorType: "LINK",
              color: {
                rgbColor: { red: 0.06666667, green: 0.33333334, blue: 0.8 },
              },
            },
          ],
        },
      },
      sheets: [
        {
          properties: {
            sheetId: 0,
            title: "profiles-10.csv",
            index: 0,
            sheetType: "GRID",
            gridProperties: { rowCount: 1000, columnCount: 26 },
          },
        },
        {
          properties: {
            sheetId: 1019017811,
            title: "food.csv",
            index: 1,
            sheetType: "GRID",
            gridProperties: { rowCount: 991, columnCount: 26 },
          },
        },
        {
          properties: {
            sheetId: 199360783,
            title: "purchases",
            index: 2,
            sheetType: "GRID",
            gridProperties: { rowCount: 1999, columnCount: 26 },
          },
        },
        {
          properties: {
            sheetId: 1502334165,
            title: "profiles-10-destination.csv",
            index: 3,
            sheetType: "GRID",
            gridProperties: { rowCount: 1000, columnCount: 26 },
          },
        },
        {
          properties: {
            sheetId: 107110394,
            title: "export-records",
            index: 4,
            sheetType: "GRID",
            gridProperties: { rowCount: 1000, columnCount: 26 },
          },
        },
      ],
      spreadsheetUrl:
        "https://docs.google.com/spreadsheets/d/11zccS101c27B9mYLMJiaAPfDgoj2chOq39n3MZrcKTk/edit",
    },
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Date",
      "Tue, 25 Jan 2022 20:01:21 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Accept-Ranges",
      "none",
      "Vary",
      "Origin,Accept-Encoding",
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://sheets.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/v4/spreadsheets/11zccS101c27B9mYLMJiaAPfDgoj2chOq39n3MZrcKTk/values/%27profiles-10.csv%27!A1:Z1"
  )
  .once()
  .reply(
    200,
    {
      range: "'profiles-10.csv'!A1:Z1",
      majorDimension: "ROWS",
      values: [
        [
          "id",
          "first_name",
          "last_name",
          "email",
          "gender",
          "ip_address",
          "ios_app",
          "android_app",
          "vip",
          "ltv",
        ],
      ],
    },
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Date",
      "Tue, 25 Jan 2022 20:01:21 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Accept-Ranges",
      "none",
      "Vary",
      "Origin,Accept-Encoding",
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://sheets.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/v4/spreadsheets/11zccS101c27B9mYLMJiaAPfDgoj2chOq39n3MZrcKTk/values/%27profiles-10.csv%27!A2:J10001"
  )
  .once()
  .reply(
    200,
    {
      range: "'profiles-10.csv'!A2:J1000",
      majorDimension: "ROWS",
      values: [
        [
          "1",
          "Erie",
          "Jervois",
          "ejervois0@example.com",
          "Male",
          "15.247.38.72",
          "TRUE",
          "FALSE",
          "TRUE",
          "259.12",
        ],
        [
          "2",
          "Cacilie",
          "Eate",
          "ceate1@example.com",
          "Female",
          "253.146.41.201",
          "FALSE",
          "TRUE",
          "FALSE",
          "94.36",
        ],
        [
          "3",
          "Gretel",
          "Groucock",
          "ggroucock2@example.com",
          "Female",
          "211.89.110.134",
          "TRUE",
          "FALSE",
          "TRUE",
          "668.3",
        ],
        [
          "4",
          "Amata",
          "Cotesford",
          "acotesford3@example.com",
          "Female",
          "193.9.240.246",
          "TRUE",
          "TRUE",
          "TRUE",
          "489",
        ],
        [
          "5",
          "Lira",
          "Johnston",
          "ljohnston4@example.com",
          "Female",
          "53.161.58.99",
          "FALSE",
          "TRUE",
          "FALSE",
          "823.16",
        ],
        [
          "6",
          "Deni",
          "Scalia",
          "dscalia5@example.com",
          "Female",
          "138.131.148.74",
          "TRUE",
          "FALSE",
          "TRUE",
          "273.98",
        ],
        [
          "7",
          "Helga",
          "Kleis",
          "hkleis6@example.com",
          "Female",
          "85.248.8.158",
          "TRUE",
          "TRUE",
          "TRUE",
          "407.05",
        ],
        [
          "8",
          "Gertie",
          "Cubitt",
          "gcubitt7@example.com",
          "Female",
          "123.255.130.24",
          "FALSE",
          "FALSE",
          "TRUE",
          "841.45",
        ],
        [
          "9",
          "Lurleen",
          "Browell",
          "lbrowell8@example.com",
          "Female",
          "231.159.55.43",
          "TRUE",
          "FALSE",
          "FALSE",
          "623.34",
        ],
        [
          "10",
          "Dorthy",
          "Iston",
          "diston9@example.com",
          "Female",
          "45.241.64.163",
          "FALSE",
          "TRUE",
          "FALSE",
          "290.53",
        ],
      ],
    },
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Date",
      "Tue, 25 Jan 2022 20:01:21 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Accept-Ranges",
      "none",
      "Vary",
      "Origin,Accept-Encoding",
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
