const nock = require("nock");

nock("https://onesignal.com:443", { encodedQueryParams: true })
  .delete("/api/v1/players/null")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(400, { errors: ["No user with this id found"] }, [
    "Date",
    "Thu, 11 Mar 2021 15:23:42 GMT",
    "Content-Type",
    "application/json; charset=utf-8",
    "Transfer-Encoding",
    "chunked",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=daefc07c7340aa5a71a4ddd4ff979cb941615476222; expires=Sat, 10-Apr-21 15:23:42 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "status",
    "400 Bad Request",
    "cache-control",
    "no-cache",
    "access-control-allow-origin",
    "*",
    "referrer-policy",
    "strict-origin-when-cross-origin",
    "x-xss-protection",
    "1; mode=block",
    "x-request-id",
    "b6e0d408-0d37-4b7d-a2d1-ca1d36d228a4",
    "access-control-allow-headers",
    "SDK-Version",
    "x-runtime",
    "0.007814",
    "x-frame-options",
    "SAMEORIGIN",
    "x-content-type-options",
    "nosniff",
    "x-powered-by",
    "Phusion Passenger 6.0.4",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c01ab000007beff3d2000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c915dc0307be-ATL",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .post("/api/v1/players", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    external_user_id: "grouparoo",
    device_type: 11,
    identifier: "grouparoo@demo.com",
  })
  .once()
  .reply(200, { success: true, id: "37b80a80-d7a3-47c4-acc4-270767ed5541" }, [
    "Date",
    "Thu, 11 Mar 2021 15:23:44 GMT",
    "Content-Type",
    "application/json; charset=utf-8",
    "Transfer-Encoding",
    "chunked",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=dc64171abf61e0b8ff571343028ddffcb1615476222; expires=Sat, 10-Apr-21 15:23:42 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "status",
    "200 OK",
    "cache-control",
    "max-age=0, private, must-revalidate",
    "access-control-allow-origin",
    "*",
    "referrer-policy",
    "strict-origin-when-cross-origin",
    "x-xss-protection",
    "1; mode=block",
    "x-request-id",
    "e9a76bdc-6c2f-4fdd-aa7d-a806f0b03b55",
    "access-control-allow-headers",
    "SDK-Version",
    "etag",
    'W/"c39916d29ffb76849a8e3f80481345ab"',
    "x-frame-options",
    "SAMEORIGIN",
    "x-runtime",
    "1.925834",
    "x-content-type-options",
    "nosniff",
    "x-powered-by",
    "Phusion Passenger 6.0.4",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c03820000117132874000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c918dded1171-MIA",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put(
    "/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/thisdoesnotexist",
    { app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31", tags: {} }
  )
  .once()
  .reply(404, { errors: ["No users with this external_id found"] }, [
    "Date",
    "Thu, 11 Mar 2021 15:23:45 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "51",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=dc6777cf4507ed6b3506272528e745f561615476225; expires=Sat, 10-Apr-21 15:23:45 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c0cda0000f341a8835000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c927cac3f341-ATL",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: { first_name: "Joe" },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:23:45 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=d0d58306485221b8256f4873b79c685f41615476225; expires=Sat, 10-Apr-21 15:23:45 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c0df40000d51123b2a000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c9298ce8d511-MIA",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: { first_name: "Joe" },
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:23:56 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=da66dc761bec93db5bc835a81d2820b811615476236; expires=Sat, 10-Apr-21 15:23:56 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "41012d27-8c14-4337-9341-91dd7a3f2f27",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"a36b3ab2fc8ff54f7ee5d2ab0acff36f"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.011865",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 5.3.7",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37c373200005e5c3a274000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5c96b8d995e5c-TPA",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: {
      first_name: "John",
      last_name: "Doe",
      last_active_at: 1614034983,
      play_count: 10,
    },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:23:56 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=d68e11d3947b22a51352f81f1d899075d1615476236; expires=Sat, 10-Apr-21 15:23:56 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c390b000012aff48ad000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c96e78c112af-MIA",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: {
        last_name: "Doe",
        first_name: "John",
        play_count: "10",
        last_active_at: "1614034983",
      },
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:24:07 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=d29c5230b171bf0d5cbb1d6323439c8d51615476247; expires=Sat, 10-Apr-21 15:24:07 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "f42f3d2e-1cdf-4a99-a6d8-4416b04325e0",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"d6a3ecdbbef08dda69951281b390284b"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.010367",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 6.0.4",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37c640a00005eb0a73a5000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5c9b34dd85eb0-TPA",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: {
      first_name: "John",
      last_name: null,
      last_active_at: null,
      play_count: null,
    },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:24:08 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=d32740eee5364698b1a68ce6a7979987b1615476248; expires=Sat, 10-Apr-21 15:24:08 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c65fa0000f36dc015f000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c9b65fb9f36d-ATL",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: { first_name: "John" },
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:24:18 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=d595bfa239f5da40d462389a8f3bc0bb91615476258; expires=Sat, 10-Apr-21 15:24:18 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "e861f94b-4ecb-4907-9b3f-e17f288d3cb5",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"c6d818a6cfca9f8b7352b02d507a9f3b"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.012836",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 5.3.7",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37c8ec00000e9747e2b1000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5c9f79bdfe974-MIA",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: { first_name: "John", in_high_value: 1, in_spanish_speakers: 1 },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:24:18 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=dd22c9fedf51d08e135b9ac687fcb8bea1615476258; expires=Sat, 10-Apr-21 15:24:18 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37c902600005e8c96100000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5c9f9d8695e8c-TPA",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: {
        first_name: "John",
        in_high_value: "1",
        in_spanish_speakers: "1",
      },
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:24:29 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=da979387bb8c714015096aa4d587771101615476269; expires=Sat, 10-Apr-21 15:24:29 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "56e1e3c5-b24e-4579-bbe2-0386959303f8",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"cae0d3d5e6f04e947deb74ad6c946190"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.007956",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 6.0.4",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37cb945000012974e9d1000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5ca3bad201297-MIA",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: { first_name: "John", in_high_value: 1, in_spanish_speakers: null },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:24:29 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=d638e1b892e6716fc77a596adbeacef771615476269; expires=Sat, 10-Apr-21 15:24:29 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37cbaeb0000c8a3b58e7000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5ca3e4930c8a3-MIA",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: { first_name: "John", in_high_value: "1" },
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:24:40 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=df945038df5874d07326911fe2a564cce1615476280; expires=Sat, 10-Apr-21 15:24:40 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "030ff305-8ff5-417c-8a42-799a7c9b29b8",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"898f81fe148c0b7daa3ec691ad211cfe"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.009470",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 6.0.4",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37ce4000000e3be301b4000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5ca800e75e3be-ATL",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: {
      first_name: "John",
      my_weird_tag_name: "test",
      in_high_value: 1,
      in___high_value____: 1,
    },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:24:40 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=ddd408c995391a5316ae7ca2910a05af71615476280; expires=Sat, 10-Apr-21 15:24:40 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37ce4db00000d0ea2b99000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5ca815deb0d0e-ATL",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: {
        first_name: "John",
        in_high_value: "1",
        my_weird_tag_name: "test",
        in___high_value____: "1",
      },
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:24:50 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=db3a35b481be9be743248c5315da5ff0a1615476290; expires=Sat, 10-Apr-21 15:24:50 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "9e826575-95a4-4899-bc67-e9acb9a2e5a1",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"ab1a46c90191bedf2791909a816d8956"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.026092",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 5.3.7",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37d0d3300005eb0a6268000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5cac1ec6f5eb0-TPA",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .put("/api/v1/apps/c2a9750d-41ef-8cef96b99-127be5aaeb31/users/grouparoo", {
    app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31",
    tags: {
      first_name: null,
      my_weird_tag_name: null,
      some_new_tag: null,
      in_high_value: null,
      in___high_value____: null,
    },
  })
  .once()
  .reply(202, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:24:51 GMT",
    "Content-Type",
    "application/json",
    "Content-Length",
    "16",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=dcc2a359cea3913034e8bb5c3ba4bae831615476291; expires=Sat, 10-Apr-21 15:24:51 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "access-control-allow-origin",
    "*",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37d0f1500000d0e669dd000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5cac4ef620d0e-ATL",
  ]);
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .get("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(
    200,
    {
      id: "37b80a80-d7a3-47c4-acc4-270767ed5541",
      identifier: "grouparoo@demo.com",
      session_count: 1,
      language: "en",
      timezone: null,
      game_version: null,
      device_os: null,
      device_type: 11,
      device_model: null,
      ad_id: null,
      tags: {},
      last_active: 1615476223,
      playtime: 0,
      amount_spent: 0,
      created_at: 1615476223,
      invalid_identifier: false,
      badge_count: 0,
      sdk: null,
      test_type: null,
      ip: "148.101.142.23",
      external_user_id: "grouparoo",
    },
    [
      "Date",
      "Thu, 11 Mar 2021 15:25:01 GMT",
      "Content-Type",
      "application/json; charset=utf-8",
      "Transfer-Encoding",
      "chunked",
      "Connection",
      "close",
      "Set-Cookie",
      "__cfduid=df006d8f735420bef34e2b62d418b78181615476301; expires=Sat, 10-Apr-21 15:25:01 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
      "status",
      "200 OK",
      "cache-control",
      "max-age=0, private, must-revalidate",
      "access-control-allow-origin",
      "*",
      "referrer-policy",
      "strict-origin-when-cross-origin",
      "x-xss-protection",
      "1; mode=block",
      "x-request-id",
      "93b28c4a-04a8-49f0-913a-a5ef3d3278e3",
      "access-control-allow-headers",
      "SDK-Version",
      "etag",
      'W/"b793be8d94d77bc46e2daa7af61a834d"',
      "x-frame-options",
      "SAMEORIGIN",
      "x-runtime",
      "0.009069",
      "x-content-type-options",
      "nosniff",
      "x-powered-by",
      "Phusion Passenger 6.0.4",
      "CF-Cache-Status",
      "DYNAMIC",
      "cf-request-id",
      "08c37d38210000d519fc953000000001",
      "Expect-CT",
      'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
      "Server",
      "cloudflare",
      "CF-RAY",
      "62e5cb0699ded519-MIA",
    ]
  );
nock("https://onesignal.com:443", { encodedQueryParams: true })
  .delete("/api/v1/players/37b80a80-d7a3-47c4-acc4-270767ed5541")
  .query({ app_id: "c2a9750d-41ef-8cef96b99-127be5aaeb31" })
  .once()
  .reply(200, { success: true }, [
    "Date",
    "Thu, 11 Mar 2021 15:25:02 GMT",
    "Content-Type",
    "application/json; charset=utf-8",
    "Transfer-Encoding",
    "chunked",
    "Connection",
    "close",
    "Set-Cookie",
    "__cfduid=da233a6e0c5e8ecf35f324c1f4ef8dd7c1615476302; expires=Sat, 10-Apr-21 15:25:02 GMT; path=/; domain=.onesignal.com; HttpOnly; SameSite=Lax",
    "status",
    "200 OK",
    "cache-control",
    "max-age=0, private, must-revalidate",
    "access-control-allow-origin",
    "*",
    "referrer-policy",
    "strict-origin-when-cross-origin",
    "x-xss-protection",
    "1; mode=block",
    "x-request-id",
    "a2b028ce-ef2b-44e4-99ef-76d19809433c",
    "access-control-allow-headers",
    "SDK-Version",
    "etag",
    'W/"c955e57777ec0d73639dca6748560d00"',
    "x-frame-options",
    "SAMEORIGIN",
    "x-runtime",
    "0.012362",
    "x-content-type-options",
    "nosniff",
    "x-powered-by",
    "Phusion Passenger 5.3.7",
    "CF-Cache-Status",
    "DYNAMIC",
    "cf-request-id",
    "08c37d399000005725aa2a2000000001",
    "Expect-CT",
    'max-age=604800, report-uri="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct"',
    "Server",
    "cloudflare",
    "CF-RAY",
    "62e5cb08eb975725-MIA",
  ]);
