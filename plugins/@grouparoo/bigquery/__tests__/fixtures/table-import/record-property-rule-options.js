const nock = require("nock");
process.env.BIGQUERY_JEST_TIMESTAMP = "1640201483320";

nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", { grant_type: /.+/g, assertion: /.+/g })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "1d",
      "d0",
      "c9",
      "72",
      "82",
      "30",
      "00",
      "00",
      "d07fc9591d4aab92de822ca2820b88d04b2684b06a64890838fdf73afd84f75e8050cada168b7bc938f8060391e18cce2209059d347a8e69a2a2ff38775eb20e5cf1d3116a0c0425d6d2150fbbc2d9cd591c84339ced87fc3ce5fa8aa7ed3a768f9dd1c95ae1d15e59e6e5fe52f0529dab073f32f4bd141e6f498b78a8ef859faddce2a46c7696a1ca0734f6dbc6e4e394dccc02c6504d45c4a28bd02c25246993fb765d6ce17dfaa55f9f271f06aba784ebcb82cbeb012325dd70a3eb874d783dbb0b4dc3f7abbdf4f20a4d45ec524eb384ebbb6834b6116fb4ba0413c0fa2a6f588bf3b7fb730ee104fc27603154ec3da132d2b006fcfe014838b37d23010000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Wed, 22 Dec 2021 19:31:23 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .post("/bigquery/v2/projects/sample-sources/jobs", {
    configuration: {
      query: {
        useLegacySql: false,
        query: "SELECT * FROM `purchases` LIMIT 10",
        defaultDataset: { datasetId: "test_001" },
      },
    },
    jobReference: {
      projectId: "sample-sources",
      jobId: "grouparoo-job-1-1640201483320",
    },
  })
  .query({ prettyPrint: "false" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b08000000000002ff85525b6f9b3014fe2b91f73635e1121a2052b445298d98d24c2364d59e52db1ca85bc0149b565195ffbe03a469bb49ed5388bfdbb93d937b5126644a98c81e1aa8f75fee2423670434cdf075791d31c6973fe62b59cf2f95c861bdafb2d90c19a255295a54390c956c6a0e6abadd8cb25a3615ada51ca2d1d01a5a13c7b44dcbf1c663db4499823c5d89f21ec5b75a576a6a182fd1a34cca2c075a0935e2b238bd1b8fb651d5f20eb856c6fb44034394f161e6b75c72aa852c67db0de6370aea1d1454e458c1ab3061dfdf3b8f042d4619921f0507cab96c4add5685165c96a9c89aba7325d367d255f9e6836c8255b088075f0797d1cfabc14d858eb75481ba19acc2ab301e58ed2412505a949d494c590eadc1b1cdf0ffd9b602aad1a40777ae39a19667fa2c652e4fbdf1394b4d60cc63ee391d3393fb0e3809038a3addba772a5acad2772c00db9ff89cfbaeed3bb66f51009e9c9b602796c35d3fb1c03627e470469e6aa1e142a84a2ad1374baea3300e7671b45d2fe671d0b591d226d7177d716d136febd4d8e4ce342d247ed0dba14585c4b4767ae13a0ea2f9220e7f07fdc2569051bedf3ce0ca529a2b403a2e3ade573833f26b1b447f48ff14410a3594fcf35922b9033e3bd797e3412a9e0fa6288dff71715cb519bc867e81a2686b7955bb9e4d3a72adffc5f0c743ec7434ad231450ea6343fdf190c331ac5127128238f775b85e22fa1782a72149ba030000",
    ],
    [
      "ETag",
      "GWRbbcGJALorAFsileNypg==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Wed, 22 Dec 2021 19:31:24 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/bigquery/v2/projects/sample-sources/queries/grouparoo-job-1-1640201483320"
  )
  .query({ location: "US", prettyPrint: "false" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "9d",
      "94",
      "61",
      "6f",
      "da",
      "30",
      "10",
      "86",
      "ff8bf77104c5499cc448fd40bbac43a2ac0da19d345593490ca40b71663b5414f1dfe77815099bc746bf90d3e57dfdf8eec2edc0f7bcccc000ccf3e58f9af2edbb2595774d1053511752a847c54a41410f5049964af93ecbe355925cc5637ebfddcc36ce9797fce1eee2422944baa26b02063bb0c869910930f8ba0325595365cb332590dbaa89479324ba8e629558b3ac494c66e3f1f0721c817def60e034653cfb76b6afaa79ba22fac6afb669128f26d7a75d64cdea52b69e8fe3cfc3e4b42523b203f9304ca2d37a21c9ba6a0dc9e8269a26c39b5b93eb71df034f6c1ed305e5b44c69d3d38ab3279aca51332ea18e2aa825982a960aa0c5fac592b3ba229c314b652c6841dfb31d1b7aa1eb3ab6d2152c253267a592cea6ea764032498a983dab6101d828b88ed5e016fa77a3f2ae2ee3389a4a4e9ee794f3ed21e5f4ed365654cb762cbb75c03e0aedc085187b28c2bac62e04b666742ea5e36d28d075fd007b2648f0f6523a5e0dc11e444608321432acd4bc5a761f7a7fb60a1db70adb9e2a02f981a90ea7b59fc3e8f8740dc8c6e61a207e23001f011c083dd70c68757f395ff90d4d82c74d420843e3f9c13fef6f3effb721db4180f410426c808486afe97f20e13104fa2e3637a9f57ae7003a3e0df043e73085c7d7fffce5565271cb99da1f8236ab0342dbffb549ae58b35dd4761b485ed31e48895aec9f7209060b5208baff09951fe32136060000",
    ],
    [
      "ETag",
      "+diRhTTCRLrVyvUv2XziWQ==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Wed, 22 Dec 2021 19:31:24 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", { grant_type: /.+/g, assertion: /.+/g })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "ed",
      "d3",
      "41",
      "72",
      "82",
      "30",
      "00",
      "00c0bfe46c9ca844a13744d452050511ec8581181514d12440a2d3bfd7e937eafe619f202584729e88ea4cafe003a8b46f7449374366dca0c766a5a918cbdae519f26ca995427d56a244476f9f97d138898d804f63d65f044a5fad51caa62196fb31224566b6d128e04d381da9b565e95e28f757670677fce024353f04e64405b042ba6b9771c8c4436bdc85698945c624813bd7f75ddba043df29aad57039dc45249f5c12599467dcce674bf1dd8bf0b136db2df50bd23a115cceedfbf674d027d96db0d14cece2cbdcd27bc5fdab464af56c8fc219c49bd3095797233c77dfdefe1dd00154de72467992bfb60fb06174c05ffd44a81b7dfd1fd39451067e7e01fe1ec8e619040000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Wed, 22 Dec 2021 19:31:24 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .post("/bigquery/v2/projects/sample-sources/jobs", {
    configuration: {
      query: {
        useLegacySql: false,
        query: "SELECT * FROM `purchases` LIMIT 10",
        defaultDataset: { datasetId: "test_001" },
      },
    },
    jobReference: {
      projectId: "sample-sources",
      jobId: "grouparoo-job-2-1640201483320",
    },
  })
  .query({ prettyPrint: "false" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "85",
      "52",
      "6d",
      "6fa24010fe2b66efdbb5ca8b286262ee8c72172ed6a68877b94f765906ba2db0945d6c4ce37fbf59b05e9b26ed37d8795ee6999967f2c0cb844c49ccb3c706eac3977b11934b028a66f87ac79279f44b2ee1e262b9b70ed7a11c07ec66364304d72c498b2a87be144dcd404eb79b41568ba6a2b5107d14eadb7d6bec98b6693993e1d0369126214f57bc7cd0e24a55726a182fd6834c882c075a713960a238bf1b7bdba86a710f4c49e3ada38126d2f8d0f35b2e18555c94b3ed06fd1b09f50e0aca73ece03f3189bfbf551e705a0c3204ef3903ca98684aa5bb420926ca94674dddaa92e93369bb7cf54136feca5f44bdafbd1fe1f555efb642c53b2a41def656c15510f52c3d8904a4e2652b12d138072d708a19bc9fad265085225d71e79a636a4d4c2f4e6397a593e1284e4d88e349ec8ee8303699e78093c44091a7b47acba2a5283dc702b0bdb1c798e7da9e637b160560c9c8043bb11ce67a8905b63926c74bf25473054b2e2b21791796fc0983c8df45e176bd98477e1b23a54dae965d733ac4eb3e1586dc99a685c00fb21d75950b74d3d30bd6911fce1751f0dbef16b6828cb2c3e6115796d25c02c271d1d1a1c299919bad1ffe25dd530829d450b2cf6789e0b6f0d9b9be1c0f42f17cd0452afcc7c531a93d580ddd0279a17b39b347e6d0252db856ef6ad6582b9f8f462b4201a53a05ea8e871c4f668d3c83b088735f07eb9f58fd075b3973bdba030000",
    ],
    [
      "ETag",
      "hcdATJsDe++Dv1yORs6IcQ==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Wed, 22 Dec 2021 19:31:25 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/bigquery/v2/projects/sample-sources/queries/grouparoo-job-2-1640201483320"
  )
  .query({ location: "US", prettyPrint: "false" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "9d",
      "94",
      "61",
      "6f",
      "da",
      "30",
      "1086ff8bf7b104d9494c62a47e802deb9080b190224d533599c4d0741067b6538410ff7d8e5b91b0796cf40b392eefe3d7770777003ff222037db0ccd73f2b26f6efd64c7da98398c96aa3a47e94bc900c74005374ad95c3458015fc3abdd94fe245723313a15c14bbdb5bad90e923db52d03f8055ce369904fd6f0750d02dd3589e6981da97753c9a26d15d14ebc4966775627a3f1e0f86e3081c3b2740b0948becfbd55c5989f4919a1bbf62f3241e4def2e5374cbab4235ccc7f1e7417219c9a86a997c1824d165bd54745b3640329a44f3643099d9a88763073cf165cc564cb02265754f4bc19f58aa46f5b8a43e6ac31cc975b14c0223362fd6825725159c3b3ae3b80eeaf9d085c80f3dcf855ab7e12955392fb4f47eae6f0714577413f39d1e1640b54298580f6e653e9f75de33659c477325e86ec984d89f526e1736b17675a0ebc086405d1cc2c04384f83822a6c6b6096a607cad4b8bad5d90e7f502e2db4c82b797d2628d09f111b69a604b218352cfabf1ee22ffcf56e1f35611e8eb22702fb0d5e136f8351e2dced48021b1d780c81b0dc899818b90efd90d1add5fced7bca549e8bc491813643d3ff8e7fdede7ff36641804d80c21241693d0f26bfa1f93f0dc04f53c626f52c3fad718b43863d00bddd3141e5efff3c3bd627226b8de1f92d5ab03beac91f7bc5e2d7ab5f595a85807a4546ff54fb97af97efc05c97f38b032060000",
    ],
    [
      "ETag",
      "BV75t0YN+yMRVT+Pr8sVnw==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Wed, 22 Dec 2021 19:31:25 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
