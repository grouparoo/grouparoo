const nock = require("nock");
process.env.BIGQUERY_JEST_TIMESTAMP = "1588955381509";

nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", {
    grant_type: "urn:ietf:params:oauth:grant-type:jwt-bearer",
    assertion: /.+/g,
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "1d",
      "cf",
      "496e83300000c0bff89c462c2a94dea0ac61a9ccd20217448c49102560e30026eadf1b757e300f502384e7b962638f6fe01df05ad28ee8e88f6f06bf341821dabb61cfce41f64119542b4c82e6ebde4d2fa52d9baa5cc06949ed6437fbabd25e2337d6c6644ab7a6b76ea337ef12e391bf97ad15b10d52e8278e13e512b4fd93c7557eb95bb682d6655fc9fec9e36f580c8abe0cabe024993b106f22a6dfd1a64debeafc13067a4936515c09ad0994f252ce63d73e9922d1c74260aed0f52bcf6c5f47a1810b2a87e000f0367514cf55f79cc9af9a7600ffcd8af1093faf06ae29a6e0f70ff118d19305010000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:43 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .post("/bigquery/v2/projects/sample-sources/jobs", {
    configuration: {
      query: {
        useLegacySql: false,
        query: "SELECT MAX(`stamp`) AS `max` FROM `purchases`",
        defaultDataset: { datasetId: "test" },
      },
    },
    jobReference: {
      projectId: "sample-sources",
      jobId: "grouparoo-job-1-1588955381509",
    },
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00000002ff8d535b6f9b30147ecfaf40ec659396002514a8546d5142b76869ba11b2cb53629b03754b30c5266b55f5bfcf86841065eaf6689ff35dceedb9a769fa3dcd63fd42d3314d1f2a289fdedc31acbf571110285591795e38b0a5f9fde3767903c433bf7cb53e8f2e2f9b2c5aa339da1419f439ab4a02fc62b918a425ab0a5432d697847dab6f399ee73b8eed598ee937500e593293bc8ae05688825f18c6dec620652ccd0015940f08dbb4ffc6f6cc284a76074470e358d59042dc7855f743c6081294e597cb45e3a1e250ae608368a65c1cc031fe78cc3ea068334865f696124084b02a17ca594343589ed0b42a6b72c9f42c3fe5776db97d763ef445300bc691763dfaf976cd85545abfd3460b6dbd418f6bed2abcb9d6d685d4bd451cf8bad6a8f1317041f35a254238830eb78cee1a33fdcb485a0a458284a4dda5ad5cf31c599ee9e304bb24f16c07272660ec61d7413636893f84618c01751984d26ef02867b96b63d7b749ec626b8887c436c101c7b57dd7c57e7c66baded9d0c2e7b1a3ef185eda7a480948c084f28271baeb9d3e0e835114aca657ab79104c82c9a1fcdf253dc9fe114e6572142ee76389eab62a415526264db1c78d3aea80903ded16f75a174f0a284acaa4a97aa6d3791484a37134fddeb121176c0629224f8b07b56209ca38f43a1cba5cd3e8a95093d4bf2d83f097d2a8632a12420225e4e430e8ff18b20236e17f1fa1ccdedf8402c8b368e5e55a0a2ad78df083783d2fb57c74533b6e09ede1d0dc134a60294e33cecd36e3e42e94166c2017fb5634f7d1f4fbe5c852d5b153c354ba9cfe7c3aff549befbdf4fe0080e992b0da040000",
    ],
    [
      "ETag",
      "Nnp5evinkxvUOec80KP1HA==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:43 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/bigquery/v2/projects/sample-sources/queries/grouparoo-job-1-1588955381509"
  )
  .query({ location: "US" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "4d",
      "51",
      "cb",
      "6e833010bce72b907b2d15d0d242a51c481529914895a7aaaacac1210b210596da260f45fc7b6d03492eb66766d7eb195f7a86417ed3624bde0db24993bf0ad8f9210131538739f02a135c6e25161cc8a3aa064113559dcfbe83d3ea1884831db2c3c8759caf383ff6fb4d158f76905359779148e238856ccb25fed1d86879ad1534077d233de9e69616e752d3cbf164b8580693e9bd98e3568b9fab300c06e190b452adf7b55c6bfd8e3d6ee61003832282db6b4a867b88c458dbe6342f333039562c02de0e518d8d9c30ac4aca104d4999b669bb9ee7bbeeb367bb96df556718519162a11a560b721d2f50d06c8e47e59cd84d34ac814d105d0c24becbe63e1d291d74f393eb398e65bdf92f439f5ce5ba3dad7b1d5adf060fce02f894a1b4c5419bb15f2dd2e5f281cab750b1085681a6232aff6d940ac9c534e3d0ab7bffbeba1c3e23020000",
    ],
    [
      "ETag",
      "mQYAxUwALBhorvH522Wfmw==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:44 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", {
    grant_type: "urn:ietf:params:oauth:grant-type:jwt-bearer",
    assertion: /.+/g,
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "1d",
      "cfdb7243400000d07fd9e724e332caf60d1184695aeafab2c35a22c2ba24589dfe7b333d7f707e4086319926f4a00de9c03b6099000ff8e050456355e1a1d2b149752e70dc19b3f9b53702a51d506c95385e5a43b95b2d4caa85d2c04cb7dbe5566853c347f1529e7c24bfc9cf400d5d1fd956387ba5e926636aa6e3c054830edbc0456da21712072361cfbaacc2578d8b045710092dee8b9d3feb416d5788569317f5dadfaebd04991a41dcc350f6b1937e76a7efc7c5ce4371359937db1ff9aab3a3773ececd9cf215d801b2f6f5482654bf66a204e10efc37d183f5e475d548369211fcfe016eeb2db505010000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:44 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .post("/bigquery/v2/projects/sample-sources/jobs", {
    configuration: {
      query: {
        useLegacySql: false,
        query: "SELECT MAX(`date`) AS `max` FROM `purchases`",
        defaultDataset: { datasetId: "test" },
      },
    },
    jobReference: {
      projectId: "sample-sources",
      jobId: "grouparoo-job-2-1588955381509",
    },
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "8d",
      "53",
      "5d",
      "6f",
      "9b",
      "30147dcfaf40ec65939690849040a56a8b123a21a5994a48f7f192d8e642dd02a6d8b48daafef7d99010a24cdd1e7d3fce39f7dcebd78ea6e90f340bf50b4dc7347e2ca1d87db86758ffac322050ac327cfafbf6c6cbaf7743ecbf84963d20cbdc7dbebcacab68d5cd519a27d0e5ac2c08f08bf5aa1717accc51c15857027687dd8165db8e6599f6c0ea3b752b87245ad0ec4101dc0991f30bc338c8e8c58cc509a09cf21e616913379e86465eb07b20821ba7ac8624e2c6bbbc5f124690a02cbb5caf6a0d2587620329a28952716c0ef1d753f41e45692f96d54f94002284959950ca6a18c2b288c66551814ba4571994e14a72f36c05f495bb706781763dfdf9711b2201db4fda74a56d53f4b2d5aefcefd7da3697b4778803df5614557b085cd0ac2209104ea0052db37b5fbcbf6ca48150204848d87dd966d21fa381dd7770842724b24d0b477dc0d8c6130b99b84f9c118c420ca88d201477dd8f329699968dc6a86f3b03d309c743183ae1241ca35144226c9b2307903d969e45fa1ee1ad99871420679f539e334ef7d6e933df9d06eec6bbda2c5d77eece8fe33f17f4acfa87efc9e2c05f2f67b2ab6d5584ca44cceb614f8d3a7140484fdbc3bde7e2d9007941991455add45b06ae3f9d05de6d4b86bcaf05c488ec568feac2229470e8b4307479a5c12e579bd46fd6aeff4b71543995f121820232725cf47f2c5935d6e97fff41597df812aa41fe8a869e0b1996e746f891bcda973a3e9a568a1bc091653680b2b110e715636b72a838fb168a0b52c8c4c18afa7bd47ebf9d482a5b72aa36552eb7bff496df2af19db7ce1f5252e52ed9040000",
    ],
    [
      "ETag",
      "sAZVQIpMy2bRxd581cNpEw==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:44 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/bigquery/v2/projects/sample-sources/queries/grouparoo-job-2-1588955381509"
  )
  .query({ location: "US" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "4d",
      "51",
      "d1",
      "4e",
      "83",
      "30",
      "14",
      "7d",
      "e7",
      "2b",
      "48",
      "7d54226030cc640f9b2e99c9346e3aa3317be8ba0b32818bedc5b92cfcbb6d81b997b6e79c7b7b7b4e0f8eebb2afacdcb01b97adb3f4bb06b93f4b81e6e6b00055e7a4f45661a9805d986a209e9a6af9be9bc6e70fd36595ee2e89cfdf84784de7c3615ba5c427145cd71d34d238c920df288d3f2c763bde6a252fc0dc58f05fdbdcd1b4af2c7d377a999cf2056e2cffb89ccd46e3d984755263f7955e1bfb842dae1790808452c0ff432a895b10746f1d2b5e5439780a6b294075434c632ba712eb8a4b444f535ee805511c0fa2e82a0e227fd057e7283865589a86e5333b8e27249e2f70674cb3a04d45b6b0cda04f802527b19c06a3a51fd31cfaa1eff9a117faeca835dd69e5f468f53f75bc27504f12b52705d64970edb33e945b34a6c96442b2064b0baeff6b9a91e6129e2b701ae70fa1c6f47c1b020000",
    ],
    [
      "ETag",
      "rYwH8+MHUpgw/taQXccVgQ==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:45 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", {
    grant_type: "urn:ietf:params:oauth:grant-type:jwt-bearer",
    assertion: /.+/g,
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b08000000000002ff1dcf495283401400d0bbf43a49754331b9030c20101194306c28c0cf3c74014a3a967737e5bbc1fb417959c2ba66dbdcc3849e10cb39e5549e9c59d6585dcdc414df74bdeaed9254188f1969433b76087b2d944e977cdfe52cd80a6c9063a9e4b918e1c1a1e7f7e61e9522f44a621d39a3eb6eaac7f426ea18e612f545334702df1bc4613fed72f7a92682780de3906d3254824c68facc47570fccbe1efc86bb70b9a537fc1aab9664ef6ed657942eba2c86543a8f6360146653c76980033ca53cd6bcfdb20d1fee5752a303821b6d1758b3f631e3054539a0ff66b6310a8fab06f9020bfafd03bec9a4d605010000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:45 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .post("/bigquery/v2/projects/sample-sources/jobs", {
    configuration: {
      query: {
        useLegacySql: false,
        query: "SELECT MAX(`id`) AS `max` FROM `purchases`",
        defaultDataset: { datasetId: "test" },
      },
    },
    jobReference: {
      projectId: "sample-sources",
      jobId: "grouparoo-job-3-1588955381509",
    },
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "000000000002ff8d535d6fda30147de75744d9cb260d121a5242a56a63904e4894aa2174dd13d8ce4dea92c4a9edd05655fffbec848f20a66e8fbef7dc73cefdf05bcb30cc35cd23f3c230314d9e4ae0af9f1e1936bfea0c4894e8cc8f997dbfde78806e85bdf0f9cb7afa7c371f5e5ed6285a550b941529b4052b390171b1987712ceca0271c6da8ab0edb4bbaee70d5cd7f1baae3da84b05a4f194e66b4df02065212e2c6b67a3933096a4800a2a3a8465fbb8b539b30ace1e8148611dab5a4a48581fea7e4b194192b2fc7231af3d9402f812324453ede2501ce1efc7ec1d8ab24ea2d01b4a0011c2ca5c6a67350d61794c939257e48ae94d0555b8b2bc7f3602e6dc9ffaa3d0b81ede7f5ed168f5c518ce8d55865e56c65570736dac0a25fa80048855255015472024cd2b8910e1141ac42abb9dcae42ffbd85368122415ed16b6ecdbe7a8ebd9031ce33e893dc7c5b10d187bb8ef2207db64d0835e84013519a4d6aeeb51ce728c9c81a360e8bc0783be477ab14d906d3bd159e444104584f45de80231b70ceffb7e080724614c45c104dd0ece1c05fe30f49793abe5ccf7c7fef8d0fe33a727e85fc14481c360311ba9aae6a86254a6725c377b3ca8a3094835d366731f4df1a4818253a64c550b9dcc423f188ec2c95dc386baae292488bcce9ff47dc52815d06a7098ea46c3d7426fd2bc5df8c16fad51e57426801838e4e4b0e8ff58b22eacd3fffe810abdfb10ba40fd89bdbc902aacce8d888378b52f7d7c34ab1cef095dd7f67684aa90cb5344dfeeee10279f426b4106b9dc8da2fe1cf5bcdf8f2c950d3b559986abedcf26b39f95f9d67beb0f51fe9942d7040000",
    ],
    [
      "ETag",
      "BN0Xkv8eaQs0UErxkLwVSA==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:45 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/bigquery/v2/projects/sample-sources/queries/grouparoo-job-3-1588955381509"
  )
  .query({ location: "US" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "4d",
      "51",
      "d16e8230147de72b48f7e8486406a74b7cd0cd6c26cc38a62f5b7ca8e5c270c0656d9953c3bfaf2da0bcb43de7dcdbdb737ab66c9b7c2779481e6cb24be29f12f8f12606f9a60f01883295426d05e602c8adae0649635d7d17af3e5e37abde30bcef1dbcf52941c69ea693495d25d8176454d59d1552384a200d85c29f06db0d6fb49c66a06fcce89f696e68792c0cbd58aee7cff3a02b65181a69b9f1fde9cc9f9346aaccbe556b655eb1c75d001170c8195cdf5270dc03930b635ad0ac48c111587206a219a21b6b39e6581694233a8a72068eeb8d4663cf1b8c5caf3f6eab5364542698eb86cd3bb98c9728691ae041fb266e1d0caf611d431b02893ac974b351d2af09bb4f2e5cd59cb6568bb6d769b3a304b1e2a8bc08300edc619fb4613ca2362b75169297606846d557bd245271114d055895f50fe0ff521916020000",
    ],
    [
      "ETag",
      "2gPZMUP+6d7+w5TzioccDA==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:46 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://www.googleapis.com:443", { encodedQueryParams: true })
  .post("/oauth2/v4/token", {
    grant_type: "urn:ietf:params:oauth:grant-type:jwt-bearer",
    assertion: /.+/g,
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "1d",
      "cf",
      "4b",
      "72",
      "82",
      "30",
      "00",
      "00",
      "d0",
      "bb642d8e20bf74c747ace214046b281b26600a48c3278442ecf4ee75fa6ef07e002e0a328e19ef1ad2821720b002d7c5daef4c5b946452f9a7394c4785607a73e6aa3b25f9478bf15c653cf57467c68972e2df4481d730df707d0a9084e0bdcddd63f5a031923b83ee5c2b707ce97554e934301ba72446b12c35fbb37408d92da24be0684573714353b88de118a2f7fc19f36ba2b3ed576d534dbec7a955bafaa67fcbd16119a00ed1a37c0fa741722f7ad22e81b9b44de4f188ee4381d88e59f659052b4096be6664cceae76cab41b802ffcd8c8b9e3caf36c18c30f0fb07e2bdeccd05010000",
    ],
    [
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:46 GMT",
      "Server",
      "scaffolding on HTTPServer2",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Connection",
      "close",
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .post("/bigquery/v2/projects/sample-sources/jobs", {
    configuration: {
      query: {
        useLegacySql: false,
        query: "SELECT MAX(`amount`) AS `max` FROM `purchases`",
        defaultDataset: { datasetId: "test" },
      },
    },
    jobReference: {
      projectId: "sample-sources",
      jobId: "grouparoo-job-4-1588955381509",
    },
  })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00",
      "00",
      "00",
      "02",
      "ff",
      "8d",
      "53",
      "5d",
      "6f",
      "9b",
      "30",
      "14",
      "7d",
      "cf",
      "af",
      "40",
      "ec659396401a2050a9daa28456d1d2542564ebf692d8ce85ba014cb1e9d655fdefb321214499ba3dfa7e9c73eeb9d72f1d4dd3b734dbe8e79a8e69fc5842f1fcee8161fda3ca8040b1ca58c197f4f2eec7f8b7cb9c9babfbed16e6e4eef6e2a2aea2553747699e4097b3b220c0cf978b5e5cb0324705635d09d8b5ba7ddb753ddb1eb87ddbf4ea560e4934a3d95601dc0b91f373c3d8cbe8c58cc509a09cf21e616913379ece8cbc600f4004378e590d49c48d37793f258c20415976b15cd41a4a0ec50a524413a5e2d0bcc19f8fd17b14a5bd58563f5102881056664229ab6108cb221a9745052e915e6450862bc9cdb315d017fecc1f87daf5e8eefd1aa50a6cfd411b2db4758a7eadb5cbe0e65a5be792f81e71e0eb8aa402d8001734ab684284136881cbecce99e95f76d24028102424ecae6c35341dd4774d0f477848227760e3c8048c5d3cb4d1009bc4b3c0da60406d04a1b8eb7e94b16c78665ac4896c0c9607040f1d4fc27891d7b7c9a63f446860b968e399aebe43786de62105200113ca73c6e9ce3c7d1cf8a3d05f4d2f5773df9ff893c3f83f0b7a52fd2d98cae23058cec7b2ab6d5584ca444cea618f8d3a7240484fdbc3bde5e2c90079419914552d753a0ffd60340ea75f5b32e485cd2046e479f1a86e2c4209874e0b4397771a3ee76a93faedd20fbe2b8e2aa73201445040460e8bfe8f25abc63afdef5f28abf79f4235c87fd1d07321c3f2dc083f9057fb52",
      "c747d34a7103e8387d670f281b0b715ae13a0de5c9c7505c904226f656d41fa4f6fbf54852d99253b5a972b9fdf9747e5589efbc76fe00296c5ad9db040000",
    ],
    [
      "ETag",
      "4RKmFXZCz8o6OGhkkeNcXQ==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:46 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
nock("https://bigquery.googleapis.com:443", { encodedQueryParams: true })
  .get(
    "/bigquery/v2/projects/sample-sources/queries/grouparoo-job-4-1588955381509"
  )
  .query({ location: "US" })
  .once()
  .reply(
    200,
    [
      "1f",
      "8b",
      "08",
      "00",
      "00",
      "00000002ff4d514d73823014bcf32b98f45a5a19c5c1ce7850a7b69dd22f5b0fb5e321c22385028f26a1ea38fcf72601d44b92dd7d2f2fbb3958b64d7e9222223736d924ecb702bebf6020dff46101a2caa4505b89850072a9ab4152a6abd3394f3f57ec5acc87fe8c458fabbb2786dbf1b8a912e137e454d51d1452384e208b84c25f06db2d6fb482e6a06fcce9ce34b7b4dc97869e072f938f7321c7c808cfcb20984c835bd24ab5d9d76aadcd1b52dc2c20060e4508a797941c5308e583b12c685e66e008ac7808a21da21b1b9971ac4aca111d453903c7f57c7fe4797ddff57aa3ae3ac390ca040bddb07c27c7f11225cd16b8d5ae89dbc4c21bd884d04540e2b35cce9351d29f6eee5fb9037264ebf6b4b63ab43ecd9bee2588578eca8d00e3c11df64817c70cb55da9d390bc024387547dd57d221517d34c80555bff3a8f205216020000",
    ],
    [
      "ETag",
      "jFrjYZg/sF68CgdKZGMgow==",
      "Content-Type",
      "application/json; charset=UTF-8",
      "Vary",
      "Origin",
      "Vary",
      "X-Origin",
      "Vary",
      "Referer",
      "Content-Encoding",
      "gzip",
      "Date",
      "Fri, 08 May 2020 16:29:47 GMT",
      "Server",
      "ESF",
      "Cache-Control",
      "private",
      "X-XSS-Protection",
      "0",
      "X-Frame-Options",
      "SAMEORIGIN",
      "X-Content-Type-Options",
      "nosniff",
      "Alt-Svc",
      'h3-27=":443"; ma=2592000,h3-25=":443"; ma=2592000,h3-Q050=":443"; ma=2592000,h3-Q049=":443"; ma=2592000,h3-Q048=":443"; ma=2592000,h3-Q046=":443"; ma=2592000,h3-Q043=":443"; ma=2592000,quic=":443"; ma=2592000; v="46,43"',
      "Transfer-Encoding",
      "chunked",
    ]
  );
