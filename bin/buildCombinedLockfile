#!/bin/bash

# This command is for Circle CI to have one place to build a cache checksum from
# We concat all the package-lock.json files in the project into one big file.

set -e

PROJECT_ROOT=$(cd $(dirname $0)/.. && pwd)
FILES=`find $PROJECT_ROOT -name package-lock.json | grep -v node_modules | sort`
OUTPUT="$PROJECT_ROOT/combined_package_lock"

# printf "$FILES"

rm -rf $OUTPUT

for p in $FILES ; do
  echo "----- $p -----" >> $OUTPUT
  cat $p >> $OUTPUT
  printf "  added $p\r\n"
done

printf "\r\ndone!\r\n"
